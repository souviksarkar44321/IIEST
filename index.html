<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Core Usage Table</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #f8f9fa;
    }
    h2 {
        text-align: center;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        background: white;
    }
    th, td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: center;
    }
    th {
        background-color: #007bff;
        color: white;
    }
    input[type="number"], input[type="date"], input[type="text"], select {
        width: 100%;
        padding: 4px;
        box-sizing: border-box;
    }
    button {
        padding: 4px 8px;
        background-color: #28a745;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 4px;
    }
    button:hover {
        background-color: #218838;
    }
    .readonly {
        background-color: #f0f0f0;
        pointer-events: none;
    }
</style>
</head>
<body>

<h2>System Information - Core Usage</h2>

<table id="coreTable">
    <thead>
        <tr>
            <th>Serial No.</th>
            <th>System Name</th>
            <th>Total Cores</th>
            <th>Cores in Process</th>
            <th>Available Cores</th>
            <th>User's Name</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Editable System Name</th>
            <th>Cores in Process</th>
            <th>Current Status</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        <!-- Rows will be generated here -->
    </tbody>
</table>

<script>
    // Fixed 22 systems with total cores
    const systems = [
        { name: "Alpha-912", totalCores: 24 },
        { name: "Beta-913", totalCores: 24 },
        { name: "Gama-16", totalCores: 16 },
        { name: "Delta-96", totalCores: 96 },
        { name: "Lambda-256", totalCores: 256 },
        { name: "System-6", totalCores: 96 },
        { name: "System-7", totalCores: 128 },
        { name: "System-8", totalCores: 160 },
        { name: "System-9", totalCores: 192 },
        { name: "System-10", totalCores: 256 },
        { name: "System-11", totalCores: 320 },
        { name: "System-12", totalCores: 384 },
        { name: "System-13", totalCores: 512 },
        { name: "System-14", totalCores: 640 },
        { name: "System-15", totalCores: 768 },
        { name: "System-16", totalCores: 896 },
        { name: "System-17", totalCores: 1024 },
        { name: "System-18", totalCores: 1280 },
        { name: "System-19", totalCores: 1536 },
        { name: "System-20", totalCores: 1792 },
        { name: "System-21", totalCores: 2048 },
        { name: "System-22", totalCores: 2048 }
    ];

    const tableBody = document.querySelector("#coreTable tbody");

    let savedData = JSON.parse(localStorage.getItem("coreTableData")) || [];

    systems.forEach((sys, index) => {
        let rowData = savedData.find(item => item.system === sys.name) || {
            system: sys.name,
            totalCores: sys.totalCores,
            coreProcess: "",
            availableCores: sys.totalCores,
            user: "",
            startDate: "",
            endDate: "",
            editableSystem: sys.name,
            editableCores: "",
            status: "Running"
        };

        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${index + 1}</td>
            <td>${rowData.system}</td>
            <td>${rowData.totalCores}</td>
            <td><input type="number" min="0" value="${rowData.coreProcess}" class="coreProcess readonly"></td>
            <td class="availableCores">${rowData.availableCores}</td>
            <td><input type="text" value="${rowData.user}" class="readonly"></td>
            <td><input type="date" value="${rowData.startDate}" class="readonly"></td>
            <td><input type="date" value="${rowData.endDate}" class="readonly"></td>
            <td><input type="text" value="${rowData.editableSystem}" class="readonly"></td>
            <td><input type="number" min="0" value="${rowData.editableCores}" class="readonly"></td>
            <td>
                <select class="readonly">
                    <option value="Running" ${rowData.status === "Running" ? "selected" : ""}>Running</option>
                    <option value="Completed" ${rowData.status === "Completed" ? "selected" : ""}>Completed</option>
                </select>
            </td>
            <td><button class="editBtn">Edit</button></td>
        `;
        tableBody.appendChild(row);
    });

    document.addEventListener("input", function (event) {
        const row = event.target.closest("tr");
        if (row) {
            const total = parseInt(row.children[2].innerText) || 0; // fixed total cores
            const inProcess = parseInt(row.querySelector(".coreProcess").value) || 0;
            row.querySelector(".availableCores").innerText = Math.max(total - inProcess, 0);
        }
    });

    document.addEventListener("click", function (event) {
        if (event.target.classList.contains("editBtn")) {
            const row = event.target.closest("tr");
            const inputs = row.querySelectorAll("input, select");

            if (event.target.innerText === "Edit") {
                inputs.forEach(input => input.classList.remove("readonly"));
                event.target.innerText = "Save";
                event.target.style.backgroundColor = "#ffc107";
            } else {
                inputs.forEach(input => input.classList.add("readonly"));
                event.target.innerText = "Edit";
                event.target.style.backgroundColor = "#28a745";

                saveTableData();
                row.parentNode.prepend(row);
                updateSerialNumbers();
            }
        }
    });

    function saveTableData() {
        let data = [];
        document.querySelectorAll("#coreTable tbody tr").forEach(row => {
            data.push({
                system: row.children[1].innerText,
                totalCores: parseInt(row.children[2].innerText),
                coreProcess: row.querySelector(".coreProcess").value,
                availableCores: parseInt(row.querySelector(".availableCores").innerText),
                user: row.children[5].querySelector("input").value,
                startDate: row.children[6].querySelector("input").value,
                endDate: row.children[7].querySelector("input").value,
                editableSystem: row.children[8].querySelector("input").value,
                editableCores: row.children[9].querySelector("input").value,
                status: row.children[10].querySelector("select").value
            });
        });
        localStorage.setItem("coreTableData", JSON.stringify(data));
    }

    function updateSerialNumbers() {
        const rows = tableBody.querySelectorAll("tr");
        rows.forEach((row, index) => {
            row.children[0].innerText = index + 1;
        });
    }
</script>

</body>
</html>
